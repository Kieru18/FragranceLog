<GridLayout rows="*, auto" class="ns-dark bg-dark h-full">

    <ScrollView row="0">
        <StackLayout class="px-4 pb-6 space-y-6">

            <StackLayout
                *ngIf="showGreeting"
                class="px-2 pt-10 pb-1">

                <Label
                    [text]="greetingLine"
                    class="text-text-secondary text-sm mb-1">
                </Label>

                <Label
                    [text]="welcomeLine"
                    class="text-text-primary text-2xl font-semibold">
                </Label>

            </StackLayout>

            <StackLayout *ngIf="!showGreeting" height="16"></StackLayout>

            <StackLayout
                *ngIf="potd"
                class="rounded-3xl bg-dark-secondary mb-2 overflow-hidden"
                (tap)="goToPerfume(potd.perfumeId)">

                <GridLayout
                    class="px-4 pt-4 pb-3"
                    verticalAlignment="center">

                    <Label
                        text="Featured fragrance"
                        class="text-xs text-text-secondary uppercase">
                    </Label>
                </GridLayout>

                <GridLayout class="h-44 mx-4 mb-3 rounded-2xl overflow-hidden">

                    <Image
                        [src]="potdImageSrc"
                        stretch="aspectFill"
                        opacity="0.35"
                        blurRadius="20"
                        borderRadius="20">
                    </Image>

                    <Image
                        [src]="potdImageSrc"
                        stretch="aspectFit"
                        loadMode="async"
                        borderRadius="20">
                    </Image>

                </GridLayout>

                <StackLayout class="px-4 pb-4">

                    <Label
                        [text]="potd.name"
                        class="text-xl font-semibold text-text-primary mb-0.5">
                    </Label>

                    <Label
                        [text]="potd.brand"
                        class="text-sm text-text-secondary mb-2">
                    </Label>

                    <Label
                        [text]="potd.reason"
                        class="text-xs text-text-secondary mb-2">
                    </Label>

                    <StackLayout orientation="horizontal" class="items-center">

                        <Label
                            text="&#xf005;"
                            class="fas text-brand-gold text-sm mr-1">
                        </Label>

                        <Label
                            [text]="potd.avgRating.toFixed(2)"
                            class="text-text-secondary text-sm">
                        </Label>

                        <Label
                            text=" Â· "
                            class="text-text-secondary text-sm">
                        </Label>

                        <Label
                            [text]="potd.ratingCount + ' reviews'"
                            class="text-text-secondary text-sm">
                        </Label>

                    </StackLayout>

                </StackLayout>
            </StackLayout>

            <GridLayout
                columns="*, auto"
                class="px-4 items-center"
                (tap)="goToAddPerfume()">

                <StackLayout
                    col="0"
                    verticalAlignment="center">

                    <Label
                        text="Missing a fragrance?"
                        class="text-text-primary font-semibold mb-0.5">
                    </Label>

                    <Label
                        text="Help expand FragranceLog database"
                        class="text-text-secondary text-xs">
                    </Label>

                </StackLayout>

                <GridLayout
                    col="1"
                    width="48"
                    height="48"
                    class="rounded-full bg-brand-gold items-center justify-center">

                    <Label
                        text="&#xf067;"
                        class="fas text-black text-base"
                        verticalAlignment="center"
                        horizontalAlignment="center">
                    </Label>

                </GridLayout>

            </GridLayout>

            <StackLayout class="rounded-xl p-4 bg-dark-secondary mt-2">

                <Label
                    text="Recent Reviews"
                    class="text-text-secondary text-sm font-semibold mb-3">
                </Label>

                <StackLayout
                    *ngFor="let r of recentReviews; let last = last"
                    (tap)="goToPerfume(r.perfumeId)">

                    <GridLayout
                        columns="*, auto"
                        class="bg-dark rounded-2xl px-4 py-3">

                        <StackLayout col="0">

                            <Label
                                [text]="r.perfumeName"
                                class="text-text-primary font-semibold">
                            </Label>

                            <Label
                                [text]="r.brand"
                                class="text-text-secondary text-xs mt-0.5">
                            </Label>

                            <StackLayout orientation="horizontal" class="mt-1 items-center">

                                <Label
                                    text="&#xf005;"
                                    class="fas text-brand-gold text-xs mr-1">
                                </Label>

                                <Label
                                    [text]="r.rating"
                                    class="text-text-secondary text-xs">
                                </Label>

                            </StackLayout>

                            <Label
                                [text]="r.comment"
                                class="text-text-secondary text-sm mt-1"
                                textWrap="true"
                                style="line-height: 8;"
                                maxLines="3">
                            </Label>

                        </StackLayout>

                        <GridLayout
                            col="1"
                            width="64"
                            height="64"
                            class="ml-3 rounded-2xl bg-dark overflow-hidden">

                            <Image
                                [src]="r.perfumeImageUrl ? contentUrl + r.perfumeImageUrl : '~/assets/images/perfume-placeholder.png'"
                                stretch="aspectFill"
                                opacity="0.35"
                                blurRadius="12"
                                borderRadius="16">
                            </Image>

                            <Image
                                [src]="r.perfumeImageUrl ? contentUrl + r.perfumeImageUrl : '~/assets/images/perfume-placeholder.png'"
                                stretch="aspectFit"
                                loadMode="async"
                                borderRadius="16">
                            </Image>

                        </GridLayout>

                    </GridLayout>

                    <StackLayout *ngIf="!last" height="12"></StackLayout>

                </StackLayout>

            </StackLayout>

            <StackLayout class="rounded-xl p-4 bg-dark-secondary mt-4">

                <GridLayout columns="*, *, *">

                    <StackLayout col="0" class="items-center">
                        <Label
                            [text]="stats.perfumes | shortNumber"
                            class="text-text-primary text-xl font-semibold">
                        </Label>
                        <Label
                            text="Perfumes"
                            class="text-text-secondary text-xs">
                        </Label>
                    </StackLayout>

                    <StackLayout col="1" class="items-center">
                        <Label
                            [text]="stats.reviews | shortNumber"
                            class="text-text-primary text-xl font-semibold">
                        </Label>
                        <Label
                            text="Reviews"
                            class="text-text-secondary text-xs">
                        </Label>
                    </StackLayout>

                    <StackLayout col="2" class="items-center">
                        <Label
                            [text]="stats.users | shortNumber"
                            class="text-text-primary text-xl font-semibold">
                        </Label>
                        <Label
                            text="Users"
                            class="text-text-secondary text-xs">
                        </Label>
                    </StackLayout>

                </GridLayout>

            </StackLayout>

        </StackLayout>
    </ScrollView>

    <app-footer row="1"></app-footer>
</GridLayout>
