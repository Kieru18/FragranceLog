<GridLayout rows="*, auto" class="ns-dark bg-dark h-full">

    <ScrollView row="0">
        <StackLayout class="px-4 pb-6 space-y-6">

            <StackLayout
                *ngIf="showGreeting"
                class="px-2 pt-10 pb-1">

                <Label
                [text]="greetingLine"
                class="text-text-secondary text-sm mb-1">
                </Label>

                <Label
                [text]="welcomeLine"
                class="text-text-primary text-2xl font-semibold">
                </Label>

            </StackLayout>

            <StackLayout *ngIf="!showGreeting" height="16"></StackLayout>

            <StackLayout
                *ngIf="potd"
                class="rounded-3xl bg-dark-secondary mb-4 overflow-hidden"
                (tap)="goToPerfume(potd.perfumeId)">

                <GridLayout
                    class="px-4 pt-4 pb-3"
                    verticalAlignment="center">

                    <Label
                        text="Featured fragrance"
                        class="text-xs text-text-secondary uppercase">
                    </Label>
                </GridLayout>

                <GridLayout class="h-44 mx-4 mb-3 rounded-2xl overflow-hidden">

                    <Image
                        [src]="potdImageSrc"
                        stretch="aspectFill"
                        opacity="0.35"
                        blurRadius="20"
                        borderRadius="20">
                    </Image>

                    <Image
                        [src]="potdImageSrc"
                        stretch="aspectFit"
                        loadMode="async"
                        borderRadius="20">
                    </Image>

                </GridLayout>

                <StackLayout class="px-4 pb-4">

                    <Label
                        [text]="potd.name"
                        class="text-xl font-semibold text-text-primary mb-0.5">
                    </Label>

                    <Label
                        [text]="potd.brand"
                        class="text-sm text-text-secondary mb-2">
                    </Label>

                    <Label
                        [text]="potd.reason"
                        class="text-xs text-text-secondary mb-2">
                    </Label>

                    <StackLayout orientation="horizontal" class="items-center">

                    <Label
                        text="&#xf005;"
                        class="fas text-brand-gold text-sm mr-1">
                    </Label>

                    <Label
                        [text]="potd.avgRating.toFixed(2)"
                        class="text-text-secondary text-sm">
                    </Label>

                    <Label
                        text=" · "
                        class="text-text-secondary text-sm">
                    </Label>

                    <Label
                        [text]="potd.ratingCount + ' reviews'"
                        class="text-text-secondary text-sm">
                    </Label>

                    </StackLayout>

                </StackLayout>
                </StackLayout>

            <GridLayout columns="*, auto, *">
                <StackLayout col="0" class="rounded-xl p-4 bg-dark-secondary items-center">
                    <Label text="Quick Actions" class="text-text-secondary text-xs mb-3"></Label>
                    <Button [text]="actions[0].icon + ' ' + actions[0].title" (tap)="goToAddPerfume()" class="w-full py-3 rounded-lg bg-transparent border border-gray-800 text-text-primary font-medium"></Button>
                </StackLayout>

                <StackLayout col="1" class="rounded-xl p-4 bg-dark-secondary items-center transform scale-105 shadow-md mx-2" style="border-color: rgba(211,165,74,0.14);">
                    <Label text="Quick Add" class="text-text-secondary text-xs mb-2"></Label>
                    <Button [text]="actions[0].icon" (tap)="goToAddPerfume()" class="rounded-full h-14 w-14 text-xl bg-brand-gold text-bg-dark font-bold"></Button>
                </StackLayout>

                <StackLayout col="2" class="rounded-xl p-4 bg-dark-secondary items-center">
                    <Label text="Collection" class="text-text-secondary text-xs mb-3"></Label>
                    <Button [text]="actions[1].icon + ' ' + actions[1].title" [nsRouterLink]="[actions[1].route]" class="w-full py-3 rounded-lg bg-transparent border border-gray-800 text-text-primary font-medium"></Button>
                </StackLayout>
            </GridLayout>

            <StackLayout class="rounded-xl p-4 bg-dark-secondary">
                <Label text="Recent Reviews" class="text-text-secondary text-sm font-semibold mb-3"></Label>

                <StackLayout *ngFor="let r of recentReviews" class="mb-3 rounded-lg p-3 bg-dark items-start">
                    <GridLayout columns="auto, *">
                        <Image [src]="r.image" class="h-14 w-14 rounded-md mr-3" stretch="aspectFill" col="0"></Image>
                        <StackLayout col="1">
                            <Label [text]="r.perfume" class="text-text-primary font-semibold"></Label>
                            <Label [text]="'⭐ ' + r.rating" class="text-brand-gold text-sm mb-1"></Label>
                            <Label [text]="r.excerpt" class="text-text-secondary text-sm" textWrap="true"></Label>
                        </StackLayout>
                    </GridLayout>
                </StackLayout>

            </StackLayout>

            <GridLayout columns="*, *" class="rounded-xl p-4 bg-dark-secondary">
                <StackLayout>
                    <Label text="Perfumes" class="text-text-secondary text-xs"></Label>
                    <Label [text]="stats.perfumes" class="text-text-primary text-xl font-semibold"></Label>
                </StackLayout>
                <StackLayout>
                    <Label text="Reviews" class="text-text-secondary text-xs"></Label>
                    <Label [text]="stats.reviews" class="text-text-primary text-xl font-semibold"></Label>
                </StackLayout>
            </GridLayout>

        </StackLayout>
    </ScrollView>

    <app-footer row="1"></app-footer>
</GridLayout>
